package gui;

import java.awt.Font;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.sql.Time;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.concurrent.TimeUnit;

import javax.swing.ImageIcon;
import javax.swing.JLabel;
import javax.swing.Timer;

class TimerWidget extends JLabel{

	private Timer t;
	private Date startTime;

	TimerWidget() {

		this.setHorizontalAlignment(CENTER);
		this.setIcon(new ImageIcon(MainView.class.getResource("/resources/k-timer-icon.png")));
		this.setFont(new Font(getFont().getName(), Font.PLAIN, 20));

		t = new Timer(1000, new clockListener());
		t.setInitialDelay(0);
		reset();
	}

	void start() {
		t.start();
		startTime =new Date();
	}

	void pause() {
		t.stop();
	}

	void reset() {
		t.restart();
	}
	

	private class clockListener implements ActionListener {

		@Override
		public void actionPerformed(ActionEvent e) {
			TimerWidget.this.setText(getElapsedTime());
		}
		
		private String getElapsedTime() {
			Date elapsed = new Date().getTime() - startTime.getTime();
			//return TimeUnit.MILLISECONDS.toHours(elapsed) + ":" +
				//	TimeUnit.MILLISECONDS.toMinutes(elapsed) + ":" +
					//TimeUnit.MILLISECONDS.toSeconds(elapsed);
			int h = (int) ((elapsed / 1000) / 3600);
			int m = (int) (((elapsed / 1000) / 60) % 60);
			int s = (int) ((elapsed / 1000) % 60);
			String retStr =  new SimpleDateFormat("HH:mm:ss").format(new Date());
			cal.clear();
			return retStr;
					
		}
		
		
	}
}
